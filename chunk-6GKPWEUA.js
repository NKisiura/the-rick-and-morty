import{a as G}from"./chunk-72HK74FD.js";import{a as O,b as W}from"./chunk-5IP64JJY.js";import"./chunk-OLQBKCZU.js";import"./chunk-UBLMH3VJ.js";import{a as j,b as S,f as $,j as z,r as N,s as U}from"./chunk-N77CJIUJ.js";import{a as M,b as q}from"./chunk-VZYJC24G.js";import"./chunk-SELDRIOR.js";import"./chunk-DUXSHKKQ.js";import{Bb as x,Ca as B,E as I,Ea as F,Gb as k,Hb as w,Ka as r,Ya as v,_ as C,_a as f,aa as y,bb as d,db as P,ea as D,eb as R,fb as l,gb as c,hb as p,ka as s,na as T,oa as b,ob as u,qc as A,zb as h}from"./chunk-7XFWTFYN.js";import{a as m,b as g}from"./chunk-35PI25VP.js";var J={locationLoading:!1,location:null,locationError:null,charactersLoading:!1,characters:null,charactersError:null},L=(()=>{let i=class i extends j{constructor(){super(J),this.locationsApiService=s(G),this.charactersApiService=s(O),this.location=this.selectSignal(({location:t})=>t),this.locationLoading=this.selectSignal(({locationLoading:t})=>t),this.locationError=this.selectSignal(({locationError:t})=>t),this.characters=this.selectSignal(({characters:t})=>t),this.charactersLoading=this.selectSignal(({charactersLoading:t})=>t),this.charactersError=this.selectSignal(({charactersError:t})=>t),this.locationWithCharactersByIdRequested=this.effect(t=>t.pipe(y(()=>this.patchState({locationLoading:!0})),C(o=>this.locationsApiService.getLocationById(o).pipe(S(a=>{this.locationByIdSucceeded(a),a.residentIds.length&&this.locationCharactersByIdListRequested(a.residentIds)},({error:a})=>{this.locationByIdFailed(a)}))))),this.locationCharactersByIdListRequested=this.effect(t=>t.pipe(y(()=>this.patchState({charactersLoading:!0})),C(o=>this.charactersApiService.getCharactersByIdList(o).pipe(S(a=>{this.locationCharactersSucceeded(a)},({error:a})=>{this.locationCharactersFailed(a)}))))),this.locationByIdSucceeded=this.updater((t,o)=>g(m({},t),{locationLoading:!1,location:o,locationError:null})),this.locationByIdFailed=this.updater((t,o)=>g(m({},t),{locationLoading:!1,location:null,locationError:o})),this.locationCharactersSucceeded=this.updater((t,o)=>g(m({},t),{charactersLoading:!1,characters:o,charactersError:null})),this.locationCharactersFailed=this.updater((t,o)=>g(m({},t),{charactersLoading:!1,characters:null,charactersError:o}))}};i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=D({token:i,factory:i.\u0275fac});let e=i;return e})();var K=(e,i)=>i.id;function Q(e,i){e&1&&p(0,"loader")}function V(e,i){if(e&1&&(l(0,"div",4),p(1,"entity-favourite-toggle",6),l(2,"div",7),h(3),c(),l(4,"h1",8),h(5),c(),l(6,"div")(7,"div",9),h(8,"Dimension:"),c(),l(9,"div",10),h(10),c()()()),e&2){let n=i,t=u();r(),f("entityId",n.id)("entityType",t.EntityType.LOCATION),r(2),x(" ",n.type||"unknown"," "),r(2),x(" ",n.name," "),r(5),x(" ",n.dimension||"unknown"," ")}}function X(e,i){if(e&1&&p(0,"error-message",5),e&2){let n=u();f("errorMessage",n.locationError().error)}}function Y(e,i){e&1&&p(0,"loader")}function Z(e,i){if(e&1&&p(0,"character-card",13),e&2){let n=i.$implicit;f("character",n)}}function tt(e,i){e&1&&(l(0,"div",3)(1,"h2",11),h(2," Characters from this location "),c(),l(3,"div",12),P(4,Z,1,1,"character-card",13,K),c()()),e&2&&(r(4),R(i))}function et(e,i){if(e&1&&p(0,"error-message",5),e&2){let n=u();f("errorMessage",n.locationCharactersError().error)}}var Lt=(()=>{let i=class i{constructor(){this.destroyRef=s(B),this.locationDetailsStore=s(L),this.title=s(A),this.EntityType=$,this.locationId=F.required({transform:t=>+t}),this.location=this.locationDetailsStore.location,this.locationLoading=this.locationDetailsStore.locationLoading,this.locationError=this.locationDetailsStore.locationError,this.locationCharacters=this.locationDetailsStore.characters,this.locationCharactersLoading=this.locationDetailsStore.charactersLoading,this.locationCharactersError=this.locationDetailsStore.charactersError,q(this.location).pipe(I(Boolean),M(this.destroyRef)).subscribe(({name:t})=>{this.title.setTitle(`${t} - Location`)})}ngOnInit(){this.locationDetailsStore.locationWithCharactersByIdRequested(this.locationId())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=b({type:i,selectors:[["ng-component"]],inputs:{locationId:[T.SignalBased,"locationId"]},standalone:!0,features:[k([L]),w],decls:11,vars:6,consts:[[1,"py-4","lg:py-6"],[1,"container"],[1,"flex","flex-col","gap-8","lg:gap-16"],[1,"flex","flex-col","gap-4","lg:gap-6"],[1,"relative","flex","flex-col","items-start","gap-2","rounded-xl","bg-light-blue/10","p-4","font-primary","text-primary","lg:gap-4","lg:p-6"],[3,"errorMessage"],[1,"absolute","right-4","top-4","lg:right-6","lg:top-6",3,"entityId","entityType"],[1,"rounded-lg","bg-accent","px-2","py-0.5","text-sm","capitalize","text-dark-blue","lg:px-3","lg:text-base"],[1,"w-full","break-words","text-3xl","font-bold","sm:text-4xl","lg:text-5xl","xl:text-6xl"],[1,"font-light","text-blue","lg:text-lg"],[1,"text-lg","capitalize","lg:text-xl"],[1,"text-center","font-decorative","text-3xl","text-primary","sm:text-4xl","lg:text-5xl"],[1,"grid","grid-cols-1","gap-4","lg:grid-cols-2","lg:gap-6"],[3,"character"]],template:function(o,a){if(o&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),v(4,Q,1,0,"loader")(5,V,11,5,"div",4)(6,X,1,1,"error-message",5),c(),l(7,"div",3),v(8,Y,1,0,"loader")(9,tt,6,0,"div",3)(10,et,1,1,"error-message",5),c()()()()),o&2){let E,_;r(4),d(4,a.locationLoading()?4:-1),r(),d(5,(E=a.location())?5:-1,E),r(),d(6,a.locationError()&&!a.locationLoading()?6:-1),r(2),d(8,a.locationCharactersLoading()?8:-1),r(),d(9,(_=a.locationCharacters())?9:-1,_),r(),d(10,a.locationCharactersError()&&!a.locationCharactersLoading()?10:-1)}},dependencies:[W,U,N,z],changeDetection:0});let e=i;return e})();export{Lt as LocationDetailsPageComponent};
