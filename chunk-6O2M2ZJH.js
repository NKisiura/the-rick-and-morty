import{a as U}from"./chunk-TU52X63D.js";import{a as j,b as z}from"./chunk-Z7OZQTSG.js";import"./chunk-PYAA7663.js";import"./chunk-DNTDIB4D.js";import{a as R,b as S,f as O,j as $,r as W,s as N}from"./chunk-LETE22YY.js";import{a as M,b as q}from"./chunk-EUUAAR3L.js";import"./chunk-6KRU7EG5.js";import"./chunk-66XNF6FV.js";import{Ba as B,D as I,Db as k,Eb as w,Ha as r,Va as y,Xa as u,Y as v,_ as f,_a as s,ab as F,bb as P,ca as D,cb as l,db as c,eb as d,ia as p,la as T,lb as x,ma as b,nc as A,wb as h,yb as C}from"./chunk-SN7ESOYK.js";import{a as m,b as g}from"./chunk-35PI25VP.js";var H={locationLoading:!1,location:null,locationError:null,charactersLoading:!1,characters:null,charactersError:null},L=(()=>{let i=class i extends R{constructor(){super(H),this.locationsApiService=p(U),this.charactersApiService=p(j),this.location=this.selectSignal(({location:t})=>t),this.locationLoading=this.selectSignal(({locationLoading:t})=>t),this.locationError=this.selectSignal(({locationError:t})=>t),this.characters=this.selectSignal(({characters:t})=>t),this.charactersLoading=this.selectSignal(({charactersLoading:t})=>t),this.charactersError=this.selectSignal(({charactersError:t})=>t),this.locationWithCharactersByIdRequested=this.effect(t=>t.pipe(f(()=>this.patchState({locationLoading:!0})),v(o=>this.locationsApiService.getLocationById(o).pipe(S(a=>{this.locationByIdSucceeded(a),a.residentIds.length&&this.locationCharactersByIdListRequested(a.residentIds)},({error:a})=>{this.locationByIdFailed(a)}))))),this.locationCharactersByIdListRequested=this.effect(t=>t.pipe(f(()=>this.patchState({charactersLoading:!0})),v(o=>this.charactersApiService.getCharactersByIdList(o).pipe(S(a=>{this.locationCharactersSucceeded(a)},({error:a})=>{this.locationCharactersFailed(a)}))))),this.locationByIdSucceeded=this.updater((t,o)=>g(m({},t),{locationLoading:!1,location:o,locationError:null})),this.locationByIdFailed=this.updater((t,o)=>g(m({},t),{locationLoading:!1,location:null,locationError:o})),this.locationCharactersSucceeded=this.updater((t,o)=>g(m({},t),{charactersLoading:!1,characters:o,charactersError:null})),this.locationCharactersFailed=this.updater((t,o)=>g(m({},t),{charactersLoading:!1,characters:null,charactersError:o}))}};i.\u0275fac=function(o){return new(o||i)},i.\u0275prov=D({token:i,factory:i.\u0275fac});let e=i;return e})();var J=(e,i)=>i.id;function K(e,i){e&1&&d(0,"loader")}function Q(e,i){if(e&1&&(l(0,"div",4),d(1,"entity-favourite-toggle",6),l(2,"div",7),h(3),c(),l(4,"h1",8),h(5),c(),l(6,"div")(7,"div",9),h(8,"Dimension:"),c(),l(9,"div",10),h(10),c()()()),e&2){let n=i,t=x();r(),u("entityId",n.id)("entityType",t.EntityType.LOCATION),r(2),C(" ",n.type||"unknown"," "),r(2),C(" ",n.name," "),r(5),C(" ",n.dimension||"unknown"," ")}}function V(e,i){if(e&1&&d(0,"error-message",5),e&2){let n=x();u("errorMessage",n.locationError().error)}}function X(e,i){e&1&&d(0,"loader")}function Y(e,i){if(e&1&&d(0,"character-card",13),e&2){let n=i.$implicit;u("character",n)}}function Z(e,i){e&1&&(l(0,"div",3)(1,"h2",11),h(2," Characters from this location "),c(),l(3,"div",12),F(4,Y,1,1,"character-card",13,J),c()()),e&2&&(r(4),P(i))}function tt(e,i){if(e&1&&d(0,"error-message",5),e&2){let n=x();u("errorMessage",n.locationCharactersError().error)}}var St=(()=>{let i=class i{constructor(){this.locationDetailsStore=p(L),this.title=p(A),this.EntityType=O,this.locationId=B.required({transform:t=>+t}),this.location=this.locationDetailsStore.location,this.locationLoading=this.locationDetailsStore.locationLoading,this.locationError=this.locationDetailsStore.locationError,this.locationCharacters=this.locationDetailsStore.characters,this.locationCharactersLoading=this.locationDetailsStore.charactersLoading,this.locationCharactersError=this.locationDetailsStore.charactersError,q(this.location).pipe(I(Boolean),f(({name:t})=>{this.title.setTitle(`${t} - Location`)}),M()).subscribe()}ngOnInit(){this.locationDetailsStore.locationWithCharactersByIdRequested(this.locationId())}};i.\u0275fac=function(o){return new(o||i)},i.\u0275cmp=b({type:i,selectors:[["ng-component"]],inputs:{locationId:[T.SignalBased,"locationId"]},standalone:!0,features:[k([L]),w],decls:11,vars:6,consts:[[1,"py-4","lg:py-6"],[1,"container"],[1,"flex","flex-col","gap-8","lg:gap-16"],[1,"flex","flex-col","gap-4","lg:gap-6"],[1,"relative","flex","flex-col","items-start","gap-2","rounded-xl","bg-light-blue/10","p-4","font-primary","text-primary","lg:gap-4","lg:p-6"],[3,"errorMessage"],[1,"absolute","right-4","top-4","lg:right-6","lg:top-6",3,"entityId","entityType"],[1,"rounded-lg","bg-accent","px-2","py-0.5","text-sm","capitalize","text-dark-blue","lg:px-3","lg:text-base"],[1,"w-full","break-words","text-3xl","font-bold","sm:text-4xl","lg:text-5xl","xl:text-6xl"],[1,"font-light","text-blue","lg:text-lg"],[1,"text-lg","capitalize","lg:text-xl"],[1,"text-center","font-decorative","text-3xl","text-primary","sm:text-4xl","lg:text-5xl"],[1,"grid","grid-cols-1","gap-4","lg:grid-cols-2","lg:gap-6"],[3,"character"]],template:function(o,a){if(o&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),y(4,K,1,0,"loader")(5,Q,11,5,"div",4)(6,V,1,1,"error-message",5),c(),l(7,"div",3),y(8,X,1,0,"loader")(9,Z,6,0,"div",3)(10,tt,1,1,"error-message",5),c()()()()),o&2){let E,_;r(4),s(4,a.locationLoading()?4:-1),r(),s(5,(E=a.location())?5:-1,E),r(),s(6,a.locationError()&&!a.locationLoading()?6:-1),r(2),s(8,a.locationCharactersLoading()?8:-1),r(),s(9,(_=a.locationCharacters())?9:-1,_),r(),s(10,a.locationCharactersError()&&!a.locationCharactersLoading()?10:-1)}},dependencies:[z,N,W,$],changeDetection:0});let e=i;return e})();export{St as LocationDetailsPageComponent};
