import{a as U,b as H}from"./chunk-5IP64JJY.js";import"./chunk-OLQBKCZU.js";import{a as N}from"./chunk-O5AGI4DW.js";import"./chunk-UBLMH3VJ.js";import{a as W,b as E,f as z,j as G,r as J,s as K}from"./chunk-N77CJIUJ.js";import{a as O,b as $}from"./chunk-VZYJC24G.js";import"./chunk-SELDRIOR.js";import"./chunk-DUXSHKKQ.js";import{Bb as x,Ca as B,E as I,Ea as F,Gb as R,Hb as A,Ka as a,Mb as k,Nb as q,Ya as v,_ as C,_a as f,aa as y,bb as l,db as M,ea as L,eb as P,fb as n,gb as d,hb as c,hc as w,ka as p,na as T,oa as b,ob as u,qc as j,zb as h}from"./chunk-7XFWTFYN.js";import{a as m,b as g}from"./chunk-35PI25VP.js";var V={episodeLoading:!1,episode:null,episodeError:null,charactersLoading:!1,characters:null,charactersError:null},S=(()=>{let i=class i extends W{constructor(){super(V),this.episodesApiService=p(N),this.charactersApiService=p(U),this.episode=this.selectSignal(({episode:e})=>e),this.episodeLoading=this.selectSignal(({episodeLoading:e})=>e),this.episodeError=this.selectSignal(({episodeError:e})=>e),this.characters=this.selectSignal(({characters:e})=>e),this.charactersLoading=this.selectSignal(({charactersLoading:e})=>e),this.charactersError=this.selectSignal(({charactersError:e})=>e),this.episodeWithCharactersByIdRequested=this.effect(e=>e.pipe(y(()=>this.patchState({episodeLoading:!0})),C(r=>this.episodesApiService.getEpisodeById(r).pipe(E(o=>{this.episodeByIdSucceeded(o),this.episodeCharactersByIdListRequested(o.characterIds)},({error:o})=>{this.episodeByIdFailed(o)}))))),this.episodeCharactersByIdListRequested=this.effect(e=>e.pipe(y(()=>this.patchState({charactersLoading:!0})),C(r=>this.charactersApiService.getCharactersByIdList(r).pipe(E(o=>{this.episodeCharactersSucceeded(o)},({error:o})=>{this.episodeCharactersFailed(o)}))))),this.episodeByIdSucceeded=this.updater((e,r)=>g(m({},e),{episodeLoading:!1,episode:r,episodeError:null})),this.episodeByIdFailed=this.updater((e,r)=>g(m({},e),{episodeLoading:!1,episode:null,episodeError:r})),this.episodeCharactersSucceeded=this.updater((e,r)=>g(m({},e),{charactersLoading:!1,characters:r,charactersError:null})),this.episodeCharactersFailed=this.updater((e,r)=>g(m({},e),{charactersLoading:!1,characters:null,charactersError:r}))}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=L({token:i,factory:i.\u0275fac});let t=i;return t})();var X=(t,i)=>i.id;function Y(t,i){t&1&&c(0,"loader")}function Z(t,i){if(t&1&&(n(0,"div",4),c(1,"entity-favourite-toggle",6),n(2,"div",7),h(3),d(),n(4,"h1",8),h(5),d(),n(6,"div")(7,"div",9),h(8,"Air Date:"),d(),n(9,"div",10),h(10),k(11,"date"),d()()()),t&2){let s=i,e=u();a(),f("entityId",s.id)("entityType",e.EntityType.EPISODE),a(2),x(" ",s.episode," "),a(2),x(" ",s.name," "),a(5),x(" ",q(11,5,s.airDate,e.dateFormat)," ")}}function ee(t,i){if(t&1&&c(0,"error-message",5),t&2){let s=u();f("errorMessage",s.episodeError().error)}}function te(t,i){t&1&&c(0,"loader")}function ie(t,i){if(t&1&&c(0,"character-card",13),t&2){let s=i.$implicit;f("character",s)}}function re(t,i){t&1&&(n(0,"div",3)(1,"h2",11),h(2," Characters in this episode "),d(),n(3,"div",12),M(4,ie,1,1,"character-card",13,X),d()()),t&2&&(a(4),P(i))}function oe(t,i){if(t&1&&c(0,"error-message",5),t&2){let s=u();f("errorMessage",s.episodeCharactersError().error)}}var Le=(()=>{let i=class i{constructor(){this.destroyRef=p(B),this.episodeDetailsStore=p(S),this.title=p(j),this.EntityType=z,this.dateFormat="MMMM d, y",this.episodeId=F.required({transform:e=>+e}),this.episode=this.episodeDetailsStore.episode,this.episodeLoading=this.episodeDetailsStore.episodeLoading,this.episodeError=this.episodeDetailsStore.episodeError,this.episodeCharacters=this.episodeDetailsStore.characters,this.episodeCharactersLoading=this.episodeDetailsStore.charactersLoading,this.episodeCharactersError=this.episodeDetailsStore.charactersError,$(this.episode).pipe(I(Boolean),O(this.destroyRef)).subscribe(({name:e})=>{this.title.setTitle(`${e} - Episode`)})}ngOnInit(){this.episodeDetailsStore.episodeWithCharactersByIdRequested(this.episodeId())}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=b({type:i,selectors:[["ng-component"]],inputs:{episodeId:[T.SignalBased,"episodeId"]},standalone:!0,features:[R([S]),A],decls:11,vars:6,consts:[[1,"py-4","lg:py-6"],[1,"container"],[1,"flex","flex-col","gap-8","lg:gap-16"],[1,"flex","flex-col","gap-4","lg:gap-6"],[1,"relative","flex","flex-col","items-start","gap-2","rounded-xl","bg-light-blue/10","p-4","font-primary","text-primary","lg:gap-4","lg:p-6"],[3,"errorMessage"],[1,"absolute","right-4","top-4","lg:right-6","lg:top-6",3,"entityId","entityType"],[1,"rounded-lg","bg-accent","px-2","py-0.5","text-sm","text-dark-blue","lg:px-3","lg:text-base"],[1,"w-full","break-words","text-3xl","font-bold","sm:text-4xl","lg:text-5xl","xl:text-6xl"],[1,"font-light","text-blue","lg:text-lg"],[1,"text-lg","lg:text-xl"],[1,"text-center","font-decorative","text-3xl","text-primary","sm:text-4xl","lg:text-5xl"],[1,"grid","grid-cols-1","gap-4","lg:grid-cols-2","lg:gap-6"],[3,"character"]],template:function(r,o){if(r&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),v(4,Y,1,0,"loader")(5,Z,12,8,"div",4)(6,ee,1,1,"error-message",5),d(),n(7,"div",3),v(8,te,1,0,"loader")(9,re,6,0,"div",3)(10,oe,1,1,"error-message",5),d()()()()),r&2){let _,D;a(4),l(4,o.episodeLoading()?4:-1),a(),l(5,(_=o.episode())?5:-1,_),a(),l(6,o.episodeError()&&!o.episodeLoading()?6:-1),a(2),l(8,o.episodeCharactersLoading()?8:-1),a(),l(9,(D=o.episodeCharacters())?9:-1,D),a(),l(10,o.episodeCharactersError()&&!o.episodeCharactersLoading()?10:-1)}},dependencies:[w,J,K,H,G],changeDetection:0});let t=i;return t})();export{Le as EpisodeDetailsPageComponent};
